(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{47943:function(){},55024:function(){},15706:function(e,t,n){Promise.resolve().then(n.bind(n,47104)),Promise.resolve().then(n.bind(n,87290)),Promise.resolve().then(n.bind(n,90541)),Promise.resolve().then(n.bind(n,15167)),Promise.resolve().then(n.bind(n,63776))},47104:function(e,t,n){"use strict";n.r(t),n.d(t,{Changes:function(){return Changes}});var r=n(57437),i=n(14776),l=n(14703);function Changes(){let{changes:e,isLoading:t,isValidating:n,mutate:s}=(0,i.lx)();return(0,r.jsx)("section",{children:(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,r.jsx)("h1",{children:"Разница расчетного и текущего:"}),t||n?"Загрузка...":(0,r.jsx)("button",{onClick:()=>s(),children:"Обновить"}),(null==e?void 0:e.length)>0?(0,r.jsxs)("table",{cellSpacing:"16px",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Аккаунт"}),(0,r.jsx)("th",{children:"Вес голоса"}),(0,r.jsx)("th",{children:"Изменения"})]})}),(0,r.jsx)("tbody",{children:null==e?void 0:e.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,l.r)(e.id)}),(0,r.jsx)("td",{children:e.weight}),(0,r.jsx)("td",{children:e.diff})]},e.id))})]}):"Нет изменений"]})})}},87290:function(e,t,n){"use strict";n.r(t),n.d(t,{CurrentC:function(){return CurrentC}});var r=n(57437),i=n(14776),l=n(14703);function CurrentC(){let{currentC:e,error:t,mutate:n,isLoading:s,isValidating:d}=(0,i.vP)();return(0,r.jsx)("section",{children:(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,r.jsx)("h1",{children:"Текущий состав Совета"}),s||d?"Загрузка...":(0,r.jsx)("button",{onClick:()=>n(),children:"Обновить"}),(0,r.jsxs)("table",{cellSpacing:"16px",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Аккаунт"}),(0,r.jsx)("th",{children:"Вес голоса"})]})}),(0,r.jsx)("tbody",{children:null==e?void 0:e.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,l.r)(e.id)}),(0,r.jsx)("td",{children:e.count})]},e.id))})]})]})})}},90541:function(e,t,n){"use strict";n.r(t),n.d(t,{DelegateTree:function(){return DelegateTree}});var r=n(57437),i=n(14703),l=n(45266);let Tree=e=>{var t;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("li",{children:(0,r.jsxs)("div",{style:{display:"flex",gap:"16px"},children:[(0,i.r)(e.id)," ",(0,l.z)(e)]})},e.id),!!(null===(t=e.children)||void 0===t?void 0:t.length)&&(0,r.jsx)("ul",{children:e.children.map(e=>Tree(e))},"".concat(e.id,"_children"))]})};var s=n(14776);function DelegateTree(){let{tree:e,isLoading:t,isValidating:n,mutate:i,error:l}=(0,s.Aj)();return(0,r.jsx)("section",{children:(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,r.jsx)("h1",{children:"Проверка делегаций для Совета:"}),t||n?"Загрузка...":(0,r.jsx)("button",{onClick:()=>i(),children:"Обновить"}),(0,r.jsx)("ul",{children:null==e?void 0:e.map(e=>Tree(e))},"tree"),l&&(0,r.jsx)("div",{style:{color:"red"},children:l})]})})}},14703:function(e,t,n){"use strict";n.d(t,{r:function(){return Link}});var r=n(57437);let Link=e=>e?(0,r.jsx)("a",{href:"https://stellar.expert/explorer/public/account/".concat(e),target:"_blank",children:e.replace(e.substring(4,e.length-4),"...")}):null},15167:function(e,t,n){"use strict";n.r(t),n.d(t,{Members:function(){return Members}});var r=n(57437),i=n(14776),l=n(14703),s=n(2265);function Members(){let{members:e,size:t,setSize:n,data:d,isLoading:c,isValidating:a,mutate:u}=(0,i.Y5)();return(0,s.useEffect)(()=>{var e,r;d&&(null==d?void 0:null===(r=d[t-1])||void 0===r?void 0:null===(e=r.records)||void 0===e?void 0:e.length)>0&&n(t+1)},[d,t]),(0,r.jsx)("section",{children:(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,r.jsx)("h1",{children:"Открывшие линии доверия к MTLAP"}),c||a?"Загрузка...":(0,r.jsx)("button",{onClick:()=>u(),children:"Обновить"}),(0,r.jsxs)("table",{cellSpacing:"16px",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Аккаунт"}),(0,r.jsx)("th",{children:"Количество токенов MTLAP"}),(0,r.jsx)("th",{children:"Делегация в Собрании"}),(0,r.jsx)("th",{children:"Делегация в Совете"})]})}),(0,r.jsx)("tbody",{children:null==e?void 0:e.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,l.r)(e.id)}),(0,r.jsx)("td",{children:e.count}),(0,r.jsx)("td",{children:(0,l.r)(e.delegateA)}),(0,r.jsx)("td",{children:(0,l.r)(e.delegateC)})]},e.id))})]})]})})}},63776:function(e,t,n){"use strict";n.r(t),n.d(t,{NewC:function(){return NewC}});var r=n(57437),i=n(14703),l=n(14776);function NewC(){let{newC:e,isLoading:t,isValidating:n,mutate:s}=(0,l.Wt)();return(0,r.jsx)("section",{children:(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,r.jsx)("h1",{children:"Ожидаемый состав Совета"}),t||n?"Загрузка...":(0,r.jsx)("button",{onClick:()=>s(),children:"Обновить"}),(0,r.jsxs)("table",{cellSpacing:"16px",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Аккаунт"}),(0,r.jsx)("th",{children:"Количество токенов MTLAP (с учетом делегаций)"}),(0,r.jsx)("th",{children:"Вес голоса"})]})}),(0,r.jsx)("tbody",{children:null==e?void 0:e.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,i.r)(e.id)}),(0,r.jsx)("td",{children:e.count}),(0,r.jsx)("td",{children:e.weight})]},e.id))})]})]})})}},14776:function(e,t,n){"use strict";n.d(t,{lx:function(){return useGetChanges},vP:function(){return useGetCurrentC},Y5:function(){return useGetMembers},Wt:function(){return useGetNewC},Aj:function(){return useGetTree}});var r=n(69108),i=n(30713),l=n(17405);let s={mainAccount:"GCNVDZIHGX473FEI7IXCUAEXUJ4BGCKEMHF36VYP5EMS7PX2QBLAMTLA",mtlapToken:"MTLAP"};var d=n(7006),c=n.n(d),a=n(80437),u=n.n(a),o=n(47520),h=n.n(o),x=n(2265),j=n(92166),v=n(45266);let f=new r.Server("https://horizon.stellar.org"),g=new r.Asset(s.mtlapToken,s.mainAccount),useGetCurrentC=()=>{let e=(0,i.ZP)("currentC",()=>f.loadAccount(s.mainAccount)),{data:t,error:n,mutate:r,isLoading:l,isValidating:d}=e;return{currentC:null==t?void 0:t.signers.filter(e=>e.key!==s.mainAccount).map(e=>({id:e.key,count:e.weight})).sort((e,t)=>t.count-e.count),error:n,mutate:r,isLoading:l,isValidating:d}},useGetMembers=()=>{let e=(0,l.ZP)((e,t)=>{var n;return!t||(null===(n=t.records)||void 0===n?void 0:n.length)?0===e?"members":t:null},e=>"members"===e?f.accounts().forAsset(g).call():e.next(),{revalidateOnFocus:!1,revalidateFirstPage:!1,parallel:!1}),t=[];return u()(e.data,e=>e.records).forEach(e=>{var n;t.push({id:e.account_id,count:Number((null===(n=e.balances.find(e=>"credit_alphanum12"===e.asset_type&&e.asset_code===g.getCode()&&e.asset_issuer===g.getIssuer()))||void 0===n?void 0:n.balance)||0),delegateA:atob(e.data_attr.mtla_a_delegate||e.data_attr.mtla_delegate||""),delegateC:atob(e.data_attr.mtla_c_delegate||e.data_attr.mtla_delegate||"")})}),{size:e.size,setSize:e.setSize,data:e.data,isLoading:e.isLoading,isValidating:e.isValidating,mutate:e.mutate,members:t}},useGetTree=()=>{let e;let{members:t,size:n,setSize:r,data:i,isLoading:l,isValidating:s,mutate:d}=useGetMembers();(0,x.useEffect)(()=>{var e,t;i&&(null==i?void 0:null===(t=i[n-1])||void 0===t?void 0:null===(e=t.records)||void 0===e?void 0:e.length)>0&&r(n+1)},[i,n]);let c=(0,j.arrayToTree)(null==t?void 0:t.filter(e=>e.count>0),{parentId:"delegateC",dataField:null});try{(0,j.arrayToTree)(null==t?void 0:t.filter(e=>e.count>0),{parentId:"delegateC",dataField:null,throwIfOrphans:!0})}catch(n){var a;console.error(n);let t=null===(a=/\[(.+?)\]/.exec(n))||void 0===a?void 0:a[1];e="В делигациях есть циклические ссылки или ссылки на недействительных участников".concat(t?" (".concat(t,")"):"","!")}return{tree:c,isLoading:l,isValidating:s,mutate:d,error:e}},useGetNewC=()=>{let{tree:e,isLoading:t,isValidating:n,mutate:r}=useGetTree(),i=e.map(e=>({...e,count:(0,v.z)(e),weight:Math.floor(Math.log10(Math.max((0,v.z)(e),2)-1)+1)})).splice(0,20).sort((e,t)=>t.count-e.count);return{newC:i,isLoading:t,isValidating:n,mutate:r}},useGetChanges=()=>{let{currentC:e=[],mutate:t,isLoading:n,isValidating:r}=useGetCurrentC(),{newC:i,isLoading:l,isValidating:s,mutate:d}=useGetNewC(),a={},u=c()(e,i,"id");u.forEach(e=>a[e.id]=0);let o=c()(i,e,"id");o.forEach(e=>a[e.id]=e.weight);let x=h()(i,e,(e,t)=>e.id===t.id&&e.weight!==t.count);x.forEach(e=>a[e.id]=e.weight);let j=e.reduce((e,t)=>({...e,[t.id]:t.count}),{});return{changes:Object.keys(a).map(e=>{var t;let n=null!==(t=j[e])&&void 0!==t?t:0,r=a[e];return{id:e,weight:r,diff:0===n?"новый":r<n?"- ".concat(n-r):"+ ".concat(r-n)}}),isLoading:l||n,isValidating:s||r,mutate:()=>{Promise.all([d(),t()])}}}},45266:function(e,t,n){"use strict";n.d(t,{z:function(){return sumCount}});let sumCount=e=>{var t,n;return e.count+ +((null===(t=e.children)||void 0===t?void 0:t.length)?null===(n=e.children)||void 0===n?void 0:n.map(sumCount).reduce((e,t)=>e+t,0):0)}}},function(e){e.O(0,[638,795,971,864,744],function(){return e(e.s=15706)}),_N_E=e.O()}]);